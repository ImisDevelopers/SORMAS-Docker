{"remainingRequest":"/home/cirotzki/projects/virus/1_011_a_infektionsfall_uebermittellung/client/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/cirotzki/projects/virus/1_011_a_infektionsfall_uebermittellung/client/src/views/Account.vue?vue&type=style&index=0&id=04604a46&scoped=true&lang=scss&","dependencies":[{"path":"/home/cirotzki/projects/virus/1_011_a_infektionsfall_uebermittellung/client/src/views/Account.vue","mtime":1589906836724},{"path":"/home/cirotzki/projects/virus/1_011_a_infektionsfall_uebermittellung/client/node_modules/css-loader/dist/cjs.js","mtime":1584795993125},{"path":"/home/cirotzki/projects/virus/1_011_a_infektionsfall_uebermittellung/client/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":1584795993380},{"path":"/home/cirotzki/projects/virus/1_011_a_infektionsfall_uebermittellung/client/node_modules/postcss-loader/src/index.js","mtime":1584795993354},{"path":"/home/cirotzki/projects/virus/1_011_a_infektionsfall_uebermittellung/client/node_modules/sass-loader/dist/cjs.js","mtime":1586724165268},{"path":"/home/cirotzki/projects/virus/1_011_a_infektionsfall_uebermittellung/client/node_modules/cache-loader/dist/cjs.js","mtime":1584795984278},{"path":"/home/cirotzki/projects/virus/1_011_a_infektionsfall_uebermittellung/client/node_modules/vue-loader/lib/index.js","mtime":1584795993380}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCnRhYmxlIHsKICBib3JkZXItY29sbGFwc2U6IHNlcGFyYXRlOwogIGJvcmRlci1zcGFjaW5nOiAxNXB4Owp9Cg=="},{"version":3,"sources":["Account.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4TA;AACA;AACA;AACA","file":"Account.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <div style=\"max-width: 1020px; margin: 0 auto; padding: 1rem;\">\n    <ChangePasswordForm\n      @cancel=\"\n        () => {\n          showChangePasswordForm = false\n        }\n      \"\n      @create=\"\n        () => {\n          showChangePasswordForm = false\n        }\n      \"\n      :visible=\"showChangePasswordForm\"\n    />\n    <AddOrChangeUserForm\n      v-if=\"institution\"\n      @cancel=\"\n        () => {\n          showAddOrChangeUserForm = false\n        }\n      \"\n      @create=\"\n        () => {\n          showAddOrChangeUserForm = false\n        }\n      \"\n      :visible=\"showAddOrChangeUserForm\"\n      :user=\"addOrChangeUser\"\n    />\n    <ChangeInstitutionForm\n      v-if=\"institution\"\n      @cancel=\"\n        () => {\n          showChangeInstitutionForm = false\n        }\n      \"\n      @create=\"\n        () => {\n          showChangeInstitutionForm = false\n        }\n      \"\n      :visible=\"showChangeInstitutionForm\"\n      :institution=\"institution\"\n    />\n    <!-- Allgemein & Adresse -->\n    <a-row :gutter=\"8\">\n      <a-col :span=\"24\" :md=\"12\">\n        <a-card v-if=\"user\" title=\"Benutzer\" :extra=\"user.id\" align=\"left\">\n          <div>\n            <table>\n              <tr>\n                <td>Benutzername:</td>\n                <td>{{ user.username }}</td>\n              </tr>\n              <tr>\n                <td>Name:</td>\n                <td>{{ user.firstName }} {{ user.lastName }}</td>\n              </tr>\n              <tr>\n                <td>Rollen:</td>\n                <td>\n                  <div\n                    v-for=\"authority in user.authorities\"\n                    :key=\"authority.authority\"\n                  >\n                    {{ roleMapping[authority.authority] }}\n                  </div>\n                </td>\n              </tr>\n            </table>\n            <a-button\n              type=\"primary\"\n              @click=\"showChangePasswordForm = true\"\n              icon=\"edit\"\n              >Passwort wechseln</a-button\n            >\n          </div>\n        </a-card>\n      </a-col>\n      <a-col :span=\"24\" :md=\"12\">\n        <a-card\n          v-if=\"institution\"\n          title=\"Institution\"\n          :extra=\"institution.id\"\n          align=\"left\"\n        >\n          <table>\n            <tr>\n              <td>Name:</td>\n              <td>{{ institution.name }}</td>\n            </tr>\n            <tr>\n              <td>Typ:</td>\n              <td>{{ typeMapping[institution.institutionType] }}</td>\n            </tr>\n            <tr>\n              <td>Adresse:</td>\n              <td>\n                {{ institution.street }} {{ institution.houseNumber }}<br />{{\n                  institution.zip\n                }}\n                {{ institution.city }}\n              </td>\n            </tr>\n            <tr>\n              <td>E-Mail:</td>\n              <td>{{ institution.email }}</td>\n            </tr>\n            <tr>\n              <td>Telefonnummer:</td>\n              <td>{{ institution.phoneNumber }}</td>\n            </tr>\n            <tr>\n              <td>Kommentar:</td>\n              <td>{{ institution.comment }}</td>\n            </tr>\n          </table>\n          <a-button\n            v-if=\"isAdmin\"\n            type=\"primary\"\n            @click=\"showChangeInstitutionForm = true\"\n            icon=\"edit\"\n          >\n            Bearbeiten\n          </a-button>\n        </a-card>\n      </a-col>\n    </a-row>\n\n    <a-card\n      title=\"Benutzer der Institution\"\n      align=\"left\"\n      style=\"margin-top: 8px;\"\n    >\n      <div\n        style=\"display: flex; justify-content: flex-end; padding-bottom: 5px;\"\n      >\n        <a-button\n          v-if=\"isAdmin\"\n          type=\"primary\"\n          @click=\"addUser()\"\n          icon=\"user-add\"\n        >\n          Hinzufügen\n        </a-button>\n      </div>\n      <a-table\n        :columns=\"tableColumns\"\n        :dataSource=\"institutionUsers\"\n        rowKey=\"email\"\n      >\n        <div slot=\"authorities\" slot-scope=\"authorities\">\n          {{ roleMapping[authorities[1].authority] }}\n        </div>\n        <div slot=\"operation\" slot-scope=\"nothing, user\">\n          <a-button\n            v-if=\"isAdmin\"\n            type=\"primary\"\n            @click=\"() => changeUser(user)\"\n            icon=\"edit\"\n            style=\"margin-right: 10px;\"\n          ></a-button>\n          <a-popconfirm\n            title=\"Soll der Benutzer wirklich gelöscht werden?\"\n            @confirm=\"() => deleteUser(user)\"\n          >\n            <a-button v-if=\"isAdmin\" type=\"primary\" icon=\"delete\"></a-button>\n          </a-popconfirm>\n        </div>\n      </a-table>\n    </a-card>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport Vue from 'vue'\nimport { InstitutionType, UserRole } from '@/models'\nimport { authMapper } from '@/store/modules/auth.module'\nimport ChangePasswordForm from '@/components/ChangePasswordForm.vue'\nimport ChangeInstitutionForm from '@/components/ChangeInstitutionForm.vue'\nimport AddOrChangeUserForm from '@/components/AddOrChangeUserForm.vue'\nimport { UserDTO } from '@/api/SwaggerApi'\n\nconst tableColumns = [\n  {\n    title: 'Vorname',\n    key: 'firstName',\n    dataIndex: 'firstName',\n  },\n  {\n    title: 'Nachname',\n    key: 'lastName',\n    dataIndex: 'lastName',\n  },\n  {\n    title: 'Benutzername',\n    key: 'username',\n    dataIndex: 'username',\n  },\n  {\n    title: 'Rolle',\n    key: 'authorities',\n    dataIndex: 'authorities',\n    scopedSlots: { customRender: 'authorities' },\n  },\n  {\n    title: 'Aktionen',\n    key: 'id',\n    dataIndex: 'id',\n    scopedSlots: { customRender: 'operation' },\n  },\n]\n\nconst roleMapping: { [key: string]: string } = {\n  USER_ROLE_ADMIN: 'Admin',\n  USER_ROLE_REGULAR: 'Normal',\n  ROLE_LABORATORY: 'Labor',\n  ROLE_TEST_SITE: 'Teststation',\n  ROLE_CLINIC: 'Klinik',\n  ROLE_DOCTORS_OFFICE: 'Arzt',\n  ROLE_GOVERNMENT_AGENCY: 'Gesundheitsbehörde',\n  ROLE_DEPARTMENT_OF_HEALTH: 'Gesundheitsamt',\n}\n\nconst typeMapping: { [key in InstitutionType]: string } = {\n  LABORATORY: 'Labor',\n  TEST_SITE: 'Teststation',\n  CLINIC: 'Klinik',\n  DOCTORS_OFFICE: 'Arzt',\n  GOVERNMENT_AGENCY: 'Gesundheitsbehörde',\n  DEPARTMENT_OF_HEALTH: 'Gesundheitsamt',\n}\n\nexport default Vue.extend({\n  name: 'Account',\n  created() {\n    this.setIsAdmin()\n    this.getInstitutionUsers()\n  },\n  data() {\n    return {\n      tableColumns,\n      roleMapping,\n      typeMapping,\n      registerUserForm: this.$form.createForm(this),\n      showChangePasswordForm: false,\n      showChangeInstitutionForm: false,\n      showAddOrChangeUserForm: false,\n      addOrChangeUser: {},\n      isAdmin: false,\n    }\n  },\n  components: {\n    ChangePasswordForm,\n    ChangeInstitutionForm,\n    AddOrChangeUserForm,\n  },\n  computed: {\n    ...authMapper.mapState({\n      user: 'user',\n      institution: 'institution',\n      institutionUsers: 'institutionUsers',\n    }),\n    username(): string {\n      return this.user?.username || ''\n    },\n  },\n  watch: {\n    user() {\n      this.setIsAdmin()\n    },\n  },\n  methods: {\n    ...authMapper.mapActions({\n      registerUser: 'registerUserForInstitution',\n      getInstitutionUsers: 'getInstitutionUsers',\n      deleteUserForInstitution: 'deleteUserForInstitution',\n    }),\n    setIsAdmin() {\n      if (this.user && this.user.authorities) {\n        this.isAdmin = this.user.authorities.some(\n          (authority) => authority.authority === 'USER_ROLE_ADMIN'\n        )\n      }\n    },\n    changeUser(user: UserDTO) {\n      this.addOrChangeUser = user\n      this.showAddOrChangeUserForm = true\n    },\n    deleteUser(user: UserDTO) {\n      if (user.id) {\n        this.deleteUserForInstitution(user.id)\n          .then(() => {\n            this.$notification.success({\n              message: 'Benutzer erfolgreich gelöscht',\n              description: '',\n            })\n          })\n          .catch((error: Error) => {\n            this.$notification.error({\n              message: 'Benutzer konnte nicht gelöscht werden',\n              description: error.message,\n            })\n          })\n      }\n    },\n    addUser() {\n      this.addOrChangeUser = {}\n      this.showAddOrChangeUserForm = true\n    },\n  },\n})\n</script>\n\n<style scoped lang=\"scss\">\ntable {\n  border-collapse: separate;\n  border-spacing: 15px;\n}\n</style>\n"]}]}