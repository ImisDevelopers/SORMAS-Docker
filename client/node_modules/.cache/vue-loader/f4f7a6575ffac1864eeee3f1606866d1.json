{"remainingRequest":"/home/cirotzki/projects/virus/1_011_a_infektionsfall_uebermittellung/client/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/cirotzki/projects/virus/1_011_a_infektionsfall_uebermittellung/client/src/components/AddOrChangeUserForm.vue?vue&type=script&lang=ts&","dependencies":[{"path":"/home/cirotzki/projects/virus/1_011_a_infektionsfall_uebermittellung/client/src/components/AddOrChangeUserForm.vue","mtime":1589906836717},{"path":"/home/cirotzki/projects/virus/1_011_a_infektionsfall_uebermittellung/client/node_modules/cache-loader/dist/cjs.js","mtime":1584795984278},{"path":"/home/cirotzki/projects/virus/1_011_a_infektionsfall_uebermittellung/client/node_modules/thread-loader/dist/cjs.js","mtime":1584795984506},{"path":"/home/cirotzki/projects/virus/1_011_a_infektionsfall_uebermittellung/client/node_modules/babel-loader/lib/index.js","mtime":1584795984276},{"path":"/home/cirotzki/projects/virus/1_011_a_infektionsfall_uebermittellung/client/node_modules/ts-loader/index.js","mtime":1586724162024},{"path":"/home/cirotzki/projects/virus/1_011_a_infektionsfall_uebermittellung/client/node_modules/cache-loader/dist/cjs.js","mtime":1584795984278},{"path":"/home/cirotzki/projects/virus/1_011_a_infektionsfall_uebermittellung/client/node_modules/vue-loader/lib/index.js","mtime":1584795993380}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCmltcG9ydCBWdWUgZnJvbSAndnVlJwppbXBvcnQgeyBhdXRoTWFwcGVyIH0gZnJvbSAnQC9zdG9yZS9tb2R1bGVzL2F1dGgubW9kdWxlJwoKZXhwb3J0IGRlZmF1bHQgVnVlLmV4dGVuZCh7CiAgbmFtZTogJ0FjY291bnQnLAogIHByb3BzOiBbJ3Zpc2libGUnLCAndXNlciddLAogIGNvbXBvbmVudHM6IHt9LAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBmb3JtOiB0aGlzLiRmb3JtLmNyZWF0ZUZvcm0odGhpcywgeyBuYW1lOiAndXNlcicgfSksCiAgICAgIGlzTmV3VXNlcjogZmFsc2UsCiAgICB9CiAgfSwKICB3YXRjaDogewogICAgdXNlcigpIHsKICAgICAgdGhpcy5pc05ld1VzZXIgPSAhdGhpcy51c2VyLmlkCiAgICB9LAogIH0sCiAgbWV0aG9kczogewogICAgLi4uYXV0aE1hcHBlci5tYXBBY3Rpb25zKHsKICAgICAgcmVnaXN0ZXJVc2VyRm9ySW5zdGl0dXRpb246ICdyZWdpc3RlclVzZXJGb3JJbnN0aXR1dGlvbicsCiAgICAgIHVwZGF0ZVVzZXJGb3JJbnN0aXR1dGlvbjogJ3VwZGF0ZVVzZXJGb3JJbnN0aXR1dGlvbicsCiAgICB9KSwKICAgIHNhdmUoKSB7CiAgICAgIHRoaXMuZm9ybS52YWxpZGF0ZUZpZWxkcygoZXJyOiBhbnksIHZhbHVlczogYW55KSA9PiB7CiAgICAgICAgaWYgKGVycikgewogICAgICAgICAgY29uc29sZS53YXJuKGVycikKICAgICAgICAgIHJldHVybgogICAgICAgIH0KICAgICAgICBpZiAodGhpcy5pc05ld1VzZXIpIHsKICAgICAgICAgIHRoaXMucmVnaXN0ZXJVc2VyRm9ySW5zdGl0dXRpb24oewogICAgICAgICAgICAuLi52YWx1ZXMsCiAgICAgICAgICB9KQogICAgICAgICAgICAudGhlbigoKSA9PiB7CiAgICAgICAgICAgICAgdGhpcy4kbm90aWZpY2F0aW9uLnN1Y2Nlc3MoewogICAgICAgICAgICAgICAgbWVzc2FnZTogJ0JlbnV0emVyIGVyZm9sZ3JlaWNoIGFuZ2VsZWd0JywKICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiAnJywKICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgIHRoaXMuZm9ybS5yZXNldEZpZWxkcygpCiAgICAgICAgICAgICAgdGhpcy4kZW1pdCgnY3JlYXRlJykKICAgICAgICAgICAgfSkKICAgICAgICAgICAgLmNhdGNoKChlcnJvcjogRXJyb3IpID0+IHsKICAgICAgICAgICAgICB0aGlzLiRub3RpZmljYXRpb24uZXJyb3IoewogICAgICAgICAgICAgICAgbWVzc2FnZTogJ0JlbnV0emVyIGtvbm50ZSBuaWNodCBhbmdlbGVndCB3ZXJkZW4uJywKICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBlcnJvci5tZXNzYWdlLAogICAgICAgICAgICAgIH0pCiAgICAgICAgICAgIH0pCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMudXBkYXRlVXNlckZvckluc3RpdHV0aW9uKHsKICAgICAgICAgICAgaWQ6IHRoaXMudXNlci5pZCwKICAgICAgICAgICAgLi4udmFsdWVzLAogICAgICAgICAgfSkKICAgICAgICAgICAgLnRoZW4oKCkgPT4gewogICAgICAgICAgICAgIHRoaXMuJG5vdGlmaWNhdGlvbi5zdWNjZXNzKHsKICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICdCZW51dHplciBlcmZvbGdyZWljaCBha3R1YWxpc2llcnQnLAogICAgICAgICAgICAgICAgZGVzY3JpcHRpb246ICcnLAogICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgdGhpcy5mb3JtLnJlc2V0RmllbGRzKCkKICAgICAgICAgICAgICB0aGlzLiRlbWl0KCdjcmVhdGUnKQogICAgICAgICAgICB9KQogICAgICAgICAgICAuY2F0Y2goKGVycm9yOiBFcnJvcikgPT4gewogICAgICAgICAgICAgIHRoaXMuJG5vdGlmaWNhdGlvbi5lcnJvcih7CiAgICAgICAgICAgICAgICBtZXNzYWdlOiAnQmVudXR6ZXIga29ubnRlIG5pY2h0IGFrdHVhbGlzaWVydCB3ZXJkZW4uJywKICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBlcnJvci5tZXNzYWdlLAogICAgICAgICAgICAgIH0pCiAgICAgICAgICAgIH0pCiAgICAgICAgfQogICAgICB9KQogICAgfSwKICB9LAp9KQo="},{"version":3,"sources":["AddOrChangeUserForm.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAuGA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"AddOrChangeUserForm.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <a-modal\n    :visible=\"visible\"\n    :title=\"'Nutzer ' + (isNewUser ? 'hinzufÃ¼gen' : 'bearbeiten')\"\n    :okText=\"isNewUser ? 'Anlegen' : 'Speichern'\"\n    cancelText=\"Abbrechen\"\n    @cancel=\"\n      () => {\n        $emit('cancel')\n      }\n    \"\n    @ok=\"save\"\n  >\n    <a-form :form=\"form\" :layout=\"'vertical'\">\n      <a-form-item label=\"Benutzername\">\n        <a-input\n          v-decorator=\"[\n            'username',\n            {\n              rules: [\n                {\n                  required: true,\n                  message: 'Bitte Benutzernamen eingeben',\n                },\n              ],\n              initialValue: user.username,\n            },\n          ]\"\n        />\n      </a-form-item>\n      <a-form-item label=\"Vorname\">\n        <a-input\n          v-decorator=\"[\n            'firstName',\n            {\n              rules: [\n                {\n                  required: true,\n                  message: 'Bitte Vornamen eingeben',\n                },\n              ],\n              initialValue: user.firstName,\n            },\n          ]\"\n        />\n      </a-form-item>\n      <a-form-item label=\"Nachname\">\n        <a-input\n          v-decorator=\"[\n            'lastName',\n            {\n              rules: [\n                {\n                  required: true,\n                  message: 'Bitte Nachnamen eingeben',\n                },\n              ],\n              initialValue: user.lastName,\n            },\n          ]\"\n        />\n      </a-form-item>\n      <a-form-item label=\"Passwort\" v-if=\"isNewUser\">\n        <a-input\n          type=\"password\"\n          v-decorator=\"[\n            'password',\n            {\n              rules: [\n                {\n                  required: true,\n                  message: 'Bitte Passwort eingeben',\n                },\n              ],\n              initialValue: '',\n            },\n          ]\"\n        />\n      </a-form-item>\n      <a-form-item label=\"Rolle\">\n        <a-select\n          v-decorator=\"[\n            'userRole',\n            {\n              rules: [\n                {\n                  required: true,\n                  message: 'Bitte Benutzerrolle eingeben',\n                },\n              ],\n              initialValue: user.userRole,\n            },\n          ]\"\n        >\n          <a-select-option value=\"USER_ROLE_ADMIN\">Admin</a-select-option>\n          <a-select-option value=\"USER_ROLE_REGULAR\">Regular</a-select-option>\n        </a-select>\n      </a-form-item>\n    </a-form>\n  </a-modal>\n</template>\n\n<script lang=\"ts\">\nimport Vue from 'vue'\nimport { authMapper } from '@/store/modules/auth.module'\n\nexport default Vue.extend({\n  name: 'Account',\n  props: ['visible', 'user'],\n  components: {},\n  data() {\n    return {\n      form: this.$form.createForm(this, { name: 'user' }),\n      isNewUser: false,\n    }\n  },\n  watch: {\n    user() {\n      this.isNewUser = !this.user.id\n    },\n  },\n  methods: {\n    ...authMapper.mapActions({\n      registerUserForInstitution: 'registerUserForInstitution',\n      updateUserForInstitution: 'updateUserForInstitution',\n    }),\n    save() {\n      this.form.validateFields((err: any, values: any) => {\n        if (err) {\n          console.warn(err)\n          return\n        }\n        if (this.isNewUser) {\n          this.registerUserForInstitution({\n            ...values,\n          })\n            .then(() => {\n              this.$notification.success({\n                message: 'Benutzer erfolgreich angelegt',\n                description: '',\n              })\n              this.form.resetFields()\n              this.$emit('create')\n            })\n            .catch((error: Error) => {\n              this.$notification.error({\n                message: 'Benutzer konnte nicht angelegt werden.',\n                description: error.message,\n              })\n            })\n        } else {\n          this.updateUserForInstitution({\n            id: this.user.id,\n            ...values,\n          })\n            .then(() => {\n              this.$notification.success({\n                message: 'Benutzer erfolgreich aktualisiert',\n                description: '',\n              })\n              this.form.resetFields()\n              this.$emit('create')\n            })\n            .catch((error: Error) => {\n              this.$notification.error({\n                message: 'Benutzer konnte nicht aktualisiert werden.',\n                description: error.message,\n              })\n            })\n        }\n      })\n    },\n  },\n})\n</script>\n\n<style scoped lang=\"scss\"></style>\n"]}]}