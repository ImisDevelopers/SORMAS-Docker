{"remainingRequest":"/home/cirotzki/projects/virus/1_011_a_infektionsfall_uebermittellung/client/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/cirotzki/projects/virus/1_011_a_infektionsfall_uebermittellung/client/src/views/Account.vue?vue&type=script&lang=ts&","dependencies":[{"path":"/home/cirotzki/projects/virus/1_011_a_infektionsfall_uebermittellung/client/src/views/Account.vue","mtime":1589906836724},{"path":"/home/cirotzki/projects/virus/1_011_a_infektionsfall_uebermittellung/client/node_modules/cache-loader/dist/cjs.js","mtime":1584795984278},{"path":"/home/cirotzki/projects/virus/1_011_a_infektionsfall_uebermittellung/client/node_modules/thread-loader/dist/cjs.js","mtime":1584795984506},{"path":"/home/cirotzki/projects/virus/1_011_a_infektionsfall_uebermittellung/client/node_modules/babel-loader/lib/index.js","mtime":1584795984276},{"path":"/home/cirotzki/projects/virus/1_011_a_infektionsfall_uebermittellung/client/node_modules/ts-loader/index.js","mtime":1586724162024},{"path":"/home/cirotzki/projects/virus/1_011_a_infektionsfall_uebermittellung/client/node_modules/cache-loader/dist/cjs.js","mtime":1584795984278},{"path":"/home/cirotzki/projects/virus/1_011_a_infektionsfall_uebermittellung/client/node_modules/vue-loader/lib/index.js","mtime":1584795993380}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgppbXBvcnQgVnVlIGZyb20gJ3Z1ZScKaW1wb3J0IHsgSW5zdGl0dXRpb25UeXBlLCBVc2VyUm9sZSB9IGZyb20gJ0AvbW9kZWxzJwppbXBvcnQgeyBhdXRoTWFwcGVyIH0gZnJvbSAnQC9zdG9yZS9tb2R1bGVzL2F1dGgubW9kdWxlJwppbXBvcnQgQ2hhbmdlUGFzc3dvcmRGb3JtIGZyb20gJ0AvY29tcG9uZW50cy9DaGFuZ2VQYXNzd29yZEZvcm0udnVlJwppbXBvcnQgQ2hhbmdlSW5zdGl0dXRpb25Gb3JtIGZyb20gJ0AvY29tcG9uZW50cy9DaGFuZ2VJbnN0aXR1dGlvbkZvcm0udnVlJwppbXBvcnQgQWRkT3JDaGFuZ2VVc2VyRm9ybSBmcm9tICdAL2NvbXBvbmVudHMvQWRkT3JDaGFuZ2VVc2VyRm9ybS52dWUnCmltcG9ydCB7IFVzZXJEVE8gfSBmcm9tICdAL2FwaS9Td2FnZ2VyQXBpJwoKY29uc3QgdGFibGVDb2x1bW5zID0gWwogIHsKICAgIHRpdGxlOiAnVm9ybmFtZScsCiAgICBrZXk6ICdmaXJzdE5hbWUnLAogICAgZGF0YUluZGV4OiAnZmlyc3ROYW1lJywKICB9LAogIHsKICAgIHRpdGxlOiAnTmFjaG5hbWUnLAogICAga2V5OiAnbGFzdE5hbWUnLAogICAgZGF0YUluZGV4OiAnbGFzdE5hbWUnLAogIH0sCiAgewogICAgdGl0bGU6ICdCZW51dHplcm5hbWUnLAogICAga2V5OiAndXNlcm5hbWUnLAogICAgZGF0YUluZGV4OiAndXNlcm5hbWUnLAogIH0sCiAgewogICAgdGl0bGU6ICdSb2xsZScsCiAgICBrZXk6ICdhdXRob3JpdGllcycsCiAgICBkYXRhSW5kZXg6ICdhdXRob3JpdGllcycsCiAgICBzY29wZWRTbG90czogeyBjdXN0b21SZW5kZXI6ICdhdXRob3JpdGllcycgfSwKICB9LAogIHsKICAgIHRpdGxlOiAnQWt0aW9uZW4nLAogICAga2V5OiAnaWQnLAogICAgZGF0YUluZGV4OiAnaWQnLAogICAgc2NvcGVkU2xvdHM6IHsgY3VzdG9tUmVuZGVyOiAnb3BlcmF0aW9uJyB9LAogIH0sCl0KCmNvbnN0IHJvbGVNYXBwaW5nOiB7IFtrZXk6IHN0cmluZ106IHN0cmluZyB9ID0gewogIFVTRVJfUk9MRV9BRE1JTjogJ0FkbWluJywKICBVU0VSX1JPTEVfUkVHVUxBUjogJ05vcm1hbCcsCiAgUk9MRV9MQUJPUkFUT1JZOiAnTGFib3InLAogIFJPTEVfVEVTVF9TSVRFOiAnVGVzdHN0YXRpb24nLAogIFJPTEVfQ0xJTklDOiAnS2xpbmlrJywKICBST0xFX0RPQ1RPUlNfT0ZGSUNFOiAnQXJ6dCcsCiAgUk9MRV9HT1ZFUk5NRU5UX0FHRU5DWTogJ0dlc3VuZGhlaXRzYmVow7ZyZGUnLAogIFJPTEVfREVQQVJUTUVOVF9PRl9IRUFMVEg6ICdHZXN1bmRoZWl0c2FtdCcsCn0KCmNvbnN0IHR5cGVNYXBwaW5nOiB7IFtrZXkgaW4gSW5zdGl0dXRpb25UeXBlXTogc3RyaW5nIH0gPSB7CiAgTEFCT1JBVE9SWTogJ0xhYm9yJywKICBURVNUX1NJVEU6ICdUZXN0c3RhdGlvbicsCiAgQ0xJTklDOiAnS2xpbmlrJywKICBET0NUT1JTX09GRklDRTogJ0FyenQnLAogIEdPVkVSTk1FTlRfQUdFTkNZOiAnR2VzdW5kaGVpdHNiZWjDtnJkZScsCiAgREVQQVJUTUVOVF9PRl9IRUFMVEg6ICdHZXN1bmRoZWl0c2FtdCcsCn0KCmV4cG9ydCBkZWZhdWx0IFZ1ZS5leHRlbmQoewogIG5hbWU6ICdBY2NvdW50JywKICBjcmVhdGVkKCkgewogICAgdGhpcy5zZXRJc0FkbWluKCkKICAgIHRoaXMuZ2V0SW5zdGl0dXRpb25Vc2VycygpCiAgfSwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgdGFibGVDb2x1bW5zLAogICAgICByb2xlTWFwcGluZywKICAgICAgdHlwZU1hcHBpbmcsCiAgICAgIHJlZ2lzdGVyVXNlckZvcm06IHRoaXMuJGZvcm0uY3JlYXRlRm9ybSh0aGlzKSwKICAgICAgc2hvd0NoYW5nZVBhc3N3b3JkRm9ybTogZmFsc2UsCiAgICAgIHNob3dDaGFuZ2VJbnN0aXR1dGlvbkZvcm06IGZhbHNlLAogICAgICBzaG93QWRkT3JDaGFuZ2VVc2VyRm9ybTogZmFsc2UsCiAgICAgIGFkZE9yQ2hhbmdlVXNlcjoge30sCiAgICAgIGlzQWRtaW46IGZhbHNlLAogICAgfQogIH0sCiAgY29tcG9uZW50czogewogICAgQ2hhbmdlUGFzc3dvcmRGb3JtLAogICAgQ2hhbmdlSW5zdGl0dXRpb25Gb3JtLAogICAgQWRkT3JDaGFuZ2VVc2VyRm9ybSwKICB9LAogIGNvbXB1dGVkOiB7CiAgICAuLi5hdXRoTWFwcGVyLm1hcFN0YXRlKHsKICAgICAgdXNlcjogJ3VzZXInLAogICAgICBpbnN0aXR1dGlvbjogJ2luc3RpdHV0aW9uJywKICAgICAgaW5zdGl0dXRpb25Vc2VyczogJ2luc3RpdHV0aW9uVXNlcnMnLAogICAgfSksCiAgICB1c2VybmFtZSgpOiBzdHJpbmcgewogICAgICByZXR1cm4gdGhpcy51c2VyPy51c2VybmFtZSB8fCAnJwogICAgfSwKICB9LAogIHdhdGNoOiB7CiAgICB1c2VyKCkgewogICAgICB0aGlzLnNldElzQWRtaW4oKQogICAgfSwKICB9LAogIG1ldGhvZHM6IHsKICAgIC4uLmF1dGhNYXBwZXIubWFwQWN0aW9ucyh7CiAgICAgIHJlZ2lzdGVyVXNlcjogJ3JlZ2lzdGVyVXNlckZvckluc3RpdHV0aW9uJywKICAgICAgZ2V0SW5zdGl0dXRpb25Vc2VyczogJ2dldEluc3RpdHV0aW9uVXNlcnMnLAogICAgICBkZWxldGVVc2VyRm9ySW5zdGl0dXRpb246ICdkZWxldGVVc2VyRm9ySW5zdGl0dXRpb24nLAogICAgfSksCiAgICBzZXRJc0FkbWluKCkgewogICAgICBpZiAodGhpcy51c2VyICYmIHRoaXMudXNlci5hdXRob3JpdGllcykgewogICAgICAgIHRoaXMuaXNBZG1pbiA9IHRoaXMudXNlci5hdXRob3JpdGllcy5zb21lKAogICAgICAgICAgKGF1dGhvcml0eSkgPT4gYXV0aG9yaXR5LmF1dGhvcml0eSA9PT0gJ1VTRVJfUk9MRV9BRE1JTicKICAgICAgICApCiAgICAgIH0KICAgIH0sCiAgICBjaGFuZ2VVc2VyKHVzZXI6IFVzZXJEVE8pIHsKICAgICAgdGhpcy5hZGRPckNoYW5nZVVzZXIgPSB1c2VyCiAgICAgIHRoaXMuc2hvd0FkZE9yQ2hhbmdlVXNlckZvcm0gPSB0cnVlCiAgICB9LAogICAgZGVsZXRlVXNlcih1c2VyOiBVc2VyRFRPKSB7CiAgICAgIGlmICh1c2VyLmlkKSB7CiAgICAgICAgdGhpcy5kZWxldGVVc2VyRm9ySW5zdGl0dXRpb24odXNlci5pZCkKICAgICAgICAgIC50aGVuKCgpID0+IHsKICAgICAgICAgICAgdGhpcy4kbm90aWZpY2F0aW9uLnN1Y2Nlc3MoewogICAgICAgICAgICAgIG1lc3NhZ2U6ICdCZW51dHplciBlcmZvbGdyZWljaCBnZWzDtnNjaHQnLAogICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiAnJywKICAgICAgICAgICAgfSkKICAgICAgICAgIH0pCiAgICAgICAgICAuY2F0Y2goKGVycm9yOiBFcnJvcikgPT4gewogICAgICAgICAgICB0aGlzLiRub3RpZmljYXRpb24uZXJyb3IoewogICAgICAgICAgICAgIG1lc3NhZ2U6ICdCZW51dHplciBrb25udGUgbmljaHQgZ2Vsw7ZzY2h0IHdlcmRlbicsCiAgICAgICAgICAgICAgZGVzY3JpcHRpb246IGVycm9yLm1lc3NhZ2UsCiAgICAgICAgICAgIH0pCiAgICAgICAgICB9KQogICAgICB9CiAgICB9LAogICAgYWRkVXNlcigpIHsKICAgICAgdGhpcy5hZGRPckNoYW5nZVVzZXIgPSB7fQogICAgICB0aGlzLnNob3dBZGRPckNoYW5nZVVzZXJGb3JtID0gdHJ1ZQogICAgfSwKICB9LAp9KQo="},{"version":3,"sources":["Account.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgLA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Account.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <div style=\"max-width: 1020px; margin: 0 auto; padding: 1rem;\">\n    <ChangePasswordForm\n      @cancel=\"\n        () => {\n          showChangePasswordForm = false\n        }\n      \"\n      @create=\"\n        () => {\n          showChangePasswordForm = false\n        }\n      \"\n      :visible=\"showChangePasswordForm\"\n    />\n    <AddOrChangeUserForm\n      v-if=\"institution\"\n      @cancel=\"\n        () => {\n          showAddOrChangeUserForm = false\n        }\n      \"\n      @create=\"\n        () => {\n          showAddOrChangeUserForm = false\n        }\n      \"\n      :visible=\"showAddOrChangeUserForm\"\n      :user=\"addOrChangeUser\"\n    />\n    <ChangeInstitutionForm\n      v-if=\"institution\"\n      @cancel=\"\n        () => {\n          showChangeInstitutionForm = false\n        }\n      \"\n      @create=\"\n        () => {\n          showChangeInstitutionForm = false\n        }\n      \"\n      :visible=\"showChangeInstitutionForm\"\n      :institution=\"institution\"\n    />\n    <!-- Allgemein & Adresse -->\n    <a-row :gutter=\"8\">\n      <a-col :span=\"24\" :md=\"12\">\n        <a-card v-if=\"user\" title=\"Benutzer\" :extra=\"user.id\" align=\"left\">\n          <div>\n            <table>\n              <tr>\n                <td>Benutzername:</td>\n                <td>{{ user.username }}</td>\n              </tr>\n              <tr>\n                <td>Name:</td>\n                <td>{{ user.firstName }} {{ user.lastName }}</td>\n              </tr>\n              <tr>\n                <td>Rollen:</td>\n                <td>\n                  <div\n                    v-for=\"authority in user.authorities\"\n                    :key=\"authority.authority\"\n                  >\n                    {{ roleMapping[authority.authority] }}\n                  </div>\n                </td>\n              </tr>\n            </table>\n            <a-button\n              type=\"primary\"\n              @click=\"showChangePasswordForm = true\"\n              icon=\"edit\"\n              >Passwort wechseln</a-button\n            >\n          </div>\n        </a-card>\n      </a-col>\n      <a-col :span=\"24\" :md=\"12\">\n        <a-card\n          v-if=\"institution\"\n          title=\"Institution\"\n          :extra=\"institution.id\"\n          align=\"left\"\n        >\n          <table>\n            <tr>\n              <td>Name:</td>\n              <td>{{ institution.name }}</td>\n            </tr>\n            <tr>\n              <td>Typ:</td>\n              <td>{{ typeMapping[institution.institutionType] }}</td>\n            </tr>\n            <tr>\n              <td>Adresse:</td>\n              <td>\n                {{ institution.street }} {{ institution.houseNumber }}<br />{{\n                  institution.zip\n                }}\n                {{ institution.city }}\n              </td>\n            </tr>\n            <tr>\n              <td>E-Mail:</td>\n              <td>{{ institution.email }}</td>\n            </tr>\n            <tr>\n              <td>Telefonnummer:</td>\n              <td>{{ institution.phoneNumber }}</td>\n            </tr>\n            <tr>\n              <td>Kommentar:</td>\n              <td>{{ institution.comment }}</td>\n            </tr>\n          </table>\n          <a-button\n            v-if=\"isAdmin\"\n            type=\"primary\"\n            @click=\"showChangeInstitutionForm = true\"\n            icon=\"edit\"\n          >\n            Bearbeiten\n          </a-button>\n        </a-card>\n      </a-col>\n    </a-row>\n\n    <a-card\n      title=\"Benutzer der Institution\"\n      align=\"left\"\n      style=\"margin-top: 8px;\"\n    >\n      <div\n        style=\"display: flex; justify-content: flex-end; padding-bottom: 5px;\"\n      >\n        <a-button\n          v-if=\"isAdmin\"\n          type=\"primary\"\n          @click=\"addUser()\"\n          icon=\"user-add\"\n        >\n          Hinzufügen\n        </a-button>\n      </div>\n      <a-table\n        :columns=\"tableColumns\"\n        :dataSource=\"institutionUsers\"\n        rowKey=\"email\"\n      >\n        <div slot=\"authorities\" slot-scope=\"authorities\">\n          {{ roleMapping[authorities[1].authority] }}\n        </div>\n        <div slot=\"operation\" slot-scope=\"nothing, user\">\n          <a-button\n            v-if=\"isAdmin\"\n            type=\"primary\"\n            @click=\"() => changeUser(user)\"\n            icon=\"edit\"\n            style=\"margin-right: 10px;\"\n          ></a-button>\n          <a-popconfirm\n            title=\"Soll der Benutzer wirklich gelöscht werden?\"\n            @confirm=\"() => deleteUser(user)\"\n          >\n            <a-button v-if=\"isAdmin\" type=\"primary\" icon=\"delete\"></a-button>\n          </a-popconfirm>\n        </div>\n      </a-table>\n    </a-card>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport Vue from 'vue'\nimport { InstitutionType, UserRole } from '@/models'\nimport { authMapper } from '@/store/modules/auth.module'\nimport ChangePasswordForm from '@/components/ChangePasswordForm.vue'\nimport ChangeInstitutionForm from '@/components/ChangeInstitutionForm.vue'\nimport AddOrChangeUserForm from '@/components/AddOrChangeUserForm.vue'\nimport { UserDTO } from '@/api/SwaggerApi'\n\nconst tableColumns = [\n  {\n    title: 'Vorname',\n    key: 'firstName',\n    dataIndex: 'firstName',\n  },\n  {\n    title: 'Nachname',\n    key: 'lastName',\n    dataIndex: 'lastName',\n  },\n  {\n    title: 'Benutzername',\n    key: 'username',\n    dataIndex: 'username',\n  },\n  {\n    title: 'Rolle',\n    key: 'authorities',\n    dataIndex: 'authorities',\n    scopedSlots: { customRender: 'authorities' },\n  },\n  {\n    title: 'Aktionen',\n    key: 'id',\n    dataIndex: 'id',\n    scopedSlots: { customRender: 'operation' },\n  },\n]\n\nconst roleMapping: { [key: string]: string } = {\n  USER_ROLE_ADMIN: 'Admin',\n  USER_ROLE_REGULAR: 'Normal',\n  ROLE_LABORATORY: 'Labor',\n  ROLE_TEST_SITE: 'Teststation',\n  ROLE_CLINIC: 'Klinik',\n  ROLE_DOCTORS_OFFICE: 'Arzt',\n  ROLE_GOVERNMENT_AGENCY: 'Gesundheitsbehörde',\n  ROLE_DEPARTMENT_OF_HEALTH: 'Gesundheitsamt',\n}\n\nconst typeMapping: { [key in InstitutionType]: string } = {\n  LABORATORY: 'Labor',\n  TEST_SITE: 'Teststation',\n  CLINIC: 'Klinik',\n  DOCTORS_OFFICE: 'Arzt',\n  GOVERNMENT_AGENCY: 'Gesundheitsbehörde',\n  DEPARTMENT_OF_HEALTH: 'Gesundheitsamt',\n}\n\nexport default Vue.extend({\n  name: 'Account',\n  created() {\n    this.setIsAdmin()\n    this.getInstitutionUsers()\n  },\n  data() {\n    return {\n      tableColumns,\n      roleMapping,\n      typeMapping,\n      registerUserForm: this.$form.createForm(this),\n      showChangePasswordForm: false,\n      showChangeInstitutionForm: false,\n      showAddOrChangeUserForm: false,\n      addOrChangeUser: {},\n      isAdmin: false,\n    }\n  },\n  components: {\n    ChangePasswordForm,\n    ChangeInstitutionForm,\n    AddOrChangeUserForm,\n  },\n  computed: {\n    ...authMapper.mapState({\n      user: 'user',\n      institution: 'institution',\n      institutionUsers: 'institutionUsers',\n    }),\n    username(): string {\n      return this.user?.username || ''\n    },\n  },\n  watch: {\n    user() {\n      this.setIsAdmin()\n    },\n  },\n  methods: {\n    ...authMapper.mapActions({\n      registerUser: 'registerUserForInstitution',\n      getInstitutionUsers: 'getInstitutionUsers',\n      deleteUserForInstitution: 'deleteUserForInstitution',\n    }),\n    setIsAdmin() {\n      if (this.user && this.user.authorities) {\n        this.isAdmin = this.user.authorities.some(\n          (authority) => authority.authority === 'USER_ROLE_ADMIN'\n        )\n      }\n    },\n    changeUser(user: UserDTO) {\n      this.addOrChangeUser = user\n      this.showAddOrChangeUserForm = true\n    },\n    deleteUser(user: UserDTO) {\n      if (user.id) {\n        this.deleteUserForInstitution(user.id)\n          .then(() => {\n            this.$notification.success({\n              message: 'Benutzer erfolgreich gelöscht',\n              description: '',\n            })\n          })\n          .catch((error: Error) => {\n            this.$notification.error({\n              message: 'Benutzer konnte nicht gelöscht werden',\n              description: error.message,\n            })\n          })\n      }\n    },\n    addUser() {\n      this.addOrChangeUser = {}\n      this.showAddOrChangeUserForm = true\n    },\n  },\n})\n</script>\n\n<style scoped lang=\"scss\">\ntable {\n  border-collapse: separate;\n  border-spacing: 15px;\n}\n</style>\n"]}]}